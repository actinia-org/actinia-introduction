<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><link rel="canonical" href="https://pages.github.io/actinia-introduction/3_explore/" />
      <link rel="shortcut icon" href="../img/favicon.ico" />
    <title>Explore - A gentle introduction to actinia</title>
    <link rel="stylesheet" href="../css/theme.css" />
    <link rel="stylesheet" href="../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/styles/github.min.css" />
        <link href="../extra.css" rel="stylesheet" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "Explore";
        var mkdocs_page_input_path = "3_explore.md";
        var mkdocs_page_url = "/actinia-introduction/3_explore/";
      </script>
    
    <script src="../js/jquery-3.6.0.min.js" defer></script>
    <!--[if lt IE 9]>
      <script src="../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/highlight.min.js"></script>
      <script>hljs.initHighlightingOnLoad();</script> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href=".." class="icon icon-home"> A gentle introduction to actinia
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="..">A gentle introduction to actinia</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../2_concepts/">Some Concepts</a>
                </li>
              </ul>
              <ul class="current">
                <li class="toctree-l1 current"><a class="reference internal current" href="./">Explore</a>
    <ul class="current">
    <li class="toctree-l2"><a class="reference internal" href="#first-hand-on-working-with-rest-api-requests">First Hand-on: working with REST API requests</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#step-by-step">Step by step...</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#summary">Summary</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#exploring-the-api-finding-available-actinia-endpoints">Exploring the API: finding available actinia endpoints</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#rest-actinia-examples-with-curl">REST actinia examples with curl</a>
        <ul>
    <li class="toctree-l4"><a class="reference internal" href="#preparation">Preparation</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#list-available-locations">List available locations</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#list-mapsets-in-locations">List mapsets in locations</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#list-map-layers-and-their-metadata">List map layers and their metadata</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#render-maps">Render maps</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#map-layer-and-space-time-cube-queries">Map layer and space-time cube queries</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#sending-json-payload-as-a-file">Sending JSON payload as a file</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#validation-of-a-process-chain">Validation of a process chain</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#converting-a-process-chain-back-into-commands">Converting a process chain back into commands</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#data-exchange-import-and-export">Data exchange: import and export</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#dealing-with-workflows-processing-chains">Dealing with workflows (processing chains)</a>
    </li>
        </ul>
    </li>
    </ul>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../4_clients/">Client implementations</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../5_excercises/">Own exercises in actinia</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../6_conclusions/">Conclusions and future</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../about/">About the trainers</a>
                </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="..">A gentle introduction to actinia</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href=".." class="icon icon-home" alt="Docs"></a> &raquo;</li>
      <li>Explore</li>
    <li class="wy-breadcrumbs-aside">
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h1 id="explore">Explore</h1>
<h2 id="first-hand-on-working-with-rest-api-requests">First Hand-on: working with REST API requests</h2>
<!--
(duration: 50 min)
-->

<h3 id="step-by-step">Step by step...</h3>
<p>We will now send a REST API call to the actinia server and receive the server response.</p>
<p>Step 1:</p>
<ul>
<li>Get your credentials (for authentication) from the trainer or use the <code>demouser</code> with <code>gu3st!pa55w0rd</code></li>
</ul>
<p>Step 2:</p>
<ul>
<li>First try the following API call; simply in a browser: <a href="https://actinia.mundialis.de/api/v3/locations">https://actinia.mundialis.de/api/v3/locations</a></li>
<li>What does it show?</li>
</ul>
<p>Step 3:</p>
<ul>
<li>Choose and launch your REST client: cURL or RESTman or ...<ul>
<li>a) <a href="https://curl.haxx.se/docs/manpage.html">cURL</a>, on command line</li>
<li>b) <a href="https://www.thunderclient.io/">Thunderclient plugin</a>, for VS Code editor or find a plugin for your favorite editor</li>
<li>c) <a href="https://chrome.google.com/webstore/detail/restman/ihgpcfpkpmdcghlnaofdmjkoemnlijdi">RESTman</a> (<a href="https://github.com/jsargiot/restman">manual</a>), in Browser</li>
</ul>
</li>
<li>Try the same request again:</li>
</ul>
<p><center>
<a href="../img/actinia_restman01.png"><img src="../img/actinia_restman01.png" width="60%"></a><br>
<a href="../img/actinia_restman02.png"><img src="../img/actinia_restman02.png" width="60%"></a><br>
Fig. 4: Using RESTman
</center></p>
<p>For a <code>curl</code> example, see below ("<a href="index.html#rest-actinia-examples-with-curl">REST actinia examples with curl</a>").</p>
<p>Step 4:</p>
<ul>
<li>Explore the existing data on the actinia server:<ul>
<li>i.e., available GRASS locations, info, mapsets, raster, vector, and space-time datasets</li>
<li>Check the <a href="https://github.com/mundialis/actinia_core/blob/master/scripts/README.md#available-data">list of data</a> currently available on the actinia server</li>
<li>e.g.<ul>
<li><a href="https://actinia.mundialis.de/api/v3/locations">https://actinia.mundialis.de/api/v3/locations</a></li>
<li><a href="https://actinia.mundialis.de/api/v3/locations/nc_spm_08/info">https://actinia.mundialis.de/api/v3/locations/nc_spm_08/info</a></li>
<li><a href="https://actinia.mundialis.de/api/v3/locations/nc_spm_08/mapsets">https://actinia.mundialis.de/api/v3/locations/nc_spm_08/mapsets</a></li>
<li><a href="https://actinia.mundialis.de/api/v3/locations/nc_spm_08/mapsets/landsat/raster_layers">https://actinia.mundialis.de/api/v3/locations/nc_spm_08/mapsets/landsat/raster_layers</a></li>
<li><a href="https://actinia.mundialis.de/api/v3/locations/nc_spm_08/mapsets/landsat/raster_layers/lsat5_1987_10">https://actinia.mundialis.de/api/v3/locations/nc_spm_08/mapsets/landsat/raster_layers/lsat5_1987_10</a></li>
</ul>
</li>
<li>Note: <code>process_results</code> are ordered alphabetically, not thematically</li>
<li>Bonus: use the render endpoint. Here, no JSON but an image is returned: <a href="https://actinia.mundialis.de/api/v3/locations/nc_spm_08/mapsets/landsat/raster_layers/lsat5_1987_10/render">https://actinia.mundialis.de/api/v3/locations/nc_spm_08/mapsets/landsat/raster_layers/lsat5_1987_10/render</a></li>
</ul>
</li>
</ul>
<h3 id="summary">Summary</h3>
<p>So far we have seen some REST basics and explored a few endpoints provided by actinia.
Indeed the structure of the endpoints follow some GRASS GIS concepts (compare the graphical introduction above), but this does not limit us much from processing "any" geospatial data.</p>
<h2 id="exploring-the-api-finding-available-actinia-endpoints">Exploring the API: finding available actinia endpoints</h2>
<!--
(duration: 40 min)
-->

<p>The actinia REST API documentation is available online (directly generated from the source code of actinia).
Check out some of the various sections in the <a href="https://redocly.github.io/redoc/?url=https://actinia.mundialis.de/api/v3/swagger.json">actinia API docs</a>:</p>
<ul>
<li>Module Viewer</li>
<li>Process Chain Template Management</li>
<li>Authentication Management</li>
<li>API Log</li>
<li>Cache Management</li>
<li>File Management</li>
<li>Satellite Image Algorithms</li>
<li>Location Management</li>
<li>Mapset Management</li>
<li>Processing</li>
<li>Raster Management</li>
<li>Raster Statistics</li>
<li>STRDS Management (STRDS = space-time raster data set)</li>
<li>STRDS Sampling</li>
<li>STRDS Statistics</li>
<li>Vector Management</li>
<li>Mapsets</li>
<li>GeoNetwork</li>
<li>Resource Management</li>
<li>Process Chain Monitoring</li>
<li>Resource Iteration Management</li>
<li>User Management</li>
</ul>
<p>List of endpoints, shown in the web browser:</p>
<ul>
<li>To see a simple <strong>list of endpoints</strong> (and more), have a look at the "paths" section in the <a href="https://actinia.mundialis.de/api/v3/swagger.json">API JSON</a>. If the formatting looks "ugly", get the <a href="https://chrome.google.com/webstore/detail/json-formatter/bcjindcccaagfpapjjmafapmmgkkhgoa">JSON Formatter</a> extension.</li>
</ul>
<p><center>
<a href="../img/actinia_swagger_paths.png"><img src="../img/actinia_swagger_paths.png" width="60%"></a><br>
Fig. 5: actinia list of endpoints (in the "paths" section)
</center></p>
<ul>
<li><strong>List of supported processes</strong> (&gt; 500): see <a href="https://actinia.mundialis.de/api/v3/modules">API modules</a> (note: the process chain templates are at bottom, category "actinia-module")</li>
</ul>
<p><center>
<a href="../img/actinia_modules.png"><img src="../img/actinia_modules.png" width="60%"></a><br>
Fig. 6: actinia list of GRASS GIS processes (&gt; 500)
</center></p>
<p>List of endpoints shown on command line:</p>
<ul>
<li>To get the available endpoints on command line, run</li>
</ul>
<pre><code class="language-bash">## we filter the paths on the fly with `jq`
# note: no AUTH needed
curl --no-progress-meter -X GET https://actinia.mundialis.de/api/v3/swagger.json | jq &quot;.&quot;paths | jq 'keys'
[
  &quot;/actinia_modules&quot;,
  &quot;/actinia_modules/{actiniamodule}&quot;,
  &quot;/actinia_templates&quot;,
  &quot;/actinia_templates/{template_id}&quot;,
  &quot;/api_key&quot;,
  &quot;/api_log/{user_id}&quot;,
  &quot;/download_cache&quot;,
  &quot;/files&quot;,
  &quot;/grass_modules&quot;,
  &quot;/grass_modules/{grassmodule}&quot;,
  &quot;/landsat_process/{landsat_id}/{atcor_method}/{processing_method}&quot;,
  &quot;/landsat_query&quot;,
  &quot;/locations&quot;,
  &quot;/locations/{location_name}&quot;,
  &quot;/locations/{location_name}/info&quot;,
  &quot;/locations/{location_name}/mapsets&quot;,
  &quot;/locations/{location_name}/mapsets/{mapset_name}&quot;,
  &quot;/locations/{location_name}/mapsets/{mapset_name}/info&quot;,
...
  &quot;/sentinel2_query&quot;,
  &quot;/sentinel2a_aws_query&quot;,
  &quot;/token&quot;,
  &quot;/users&quot;,
  &quot;/users/{user_id}&quot;
]
</code></pre>
<!--

<pre><code>## alternative: we filter the paths on the fly with `json`
# installation: sudo npm install -g json

curl -X GET https://actinia.mundialis.de/api/v3/swagger.json | json paths | json -ka
 ... see above
</code></pre>

-->

<h3 id="rest-actinia-examples-with-curl">REST actinia examples with curl</h3>
<p>Here we use the command line and the <code>curl</code> software to communicate with the actinia server.
Optionally, to beautify the output, we use the <code>jq</code> command-line JSON processor which helps to turn the output into something human readable (<a href="https://stedolan.github.io/jq/download/">download jq</a>).</p>
<p>Hint: If you have troubles to use <code>jq</code> on command line, you can also use it in a browser at <a href="https://jqplay.org/">https://jqplay.org/</a>: copy the JSON code into the "JSON" field, then a <code>.</code> into the "Filter" field and it will show the result.</p>
<h4 id="preparation">Preparation</h4>
<p>To simplify our life in terms of server communication we store the credentials and REST server URL in environmental variables (this is only relevant for command line usage; in RESTman the browser will request the credentials):</p>
<pre><code class="language-bash"># set credentials and REST server URL
export actinia=&quot;https://actinia.mundialis.de&quot;
export AUTH='-u demouser:gu3st!pa55w0rd'
</code></pre>
<h4 id="list-available-locations">List available locations</h4>
<p>First, we want to see the list of available "locations". A location in GRASS-speak is simply a project folder which contains geospatial data:</p>
<pre><code class="language-bash"># show available locations (locations are like projects)
curl ${AUTH} -X GET ${actinia}/api/v3/locations
</code></pre>
<!--
#### Show capabilities of user


<pre><code class="language-bash"># NOTE: endpoint not available to the demouser but only to the admin user
# show accessible_datasets, accessible_modules, raster cell_limit, process_num_limit, process_time_limit
curl ${AUTH} -X GET &quot;${actinia}/api/v3/users/demouser&quot;
</code></pre>

-->

<h4 id="list-mapsets-in-locations">List mapsets in locations</h4>
<p>Next, we look at so-called "mapsets" which are subfolders in a location (just to better organise the geospatial data):</p>
<pre><code class="language-bash"># show available mapsets of a specific location
curl ${AUTH} -X GET &quot;${actinia}/api/v3/locations/nc_spm_08/mapsets&quot;
</code></pre>
<p><center>
<a href="../img/curl_output_std.png"><img src="../img/curl_output_std.png" width="60%"></a><br>
</center></p>
<p>Note the style difference of output:</p>
<pre><code class="language-bash"># show available mapsets of a specific location
curl ${AUTH} -X GET &quot;${actinia}/api/v3/locations/nc_spm_08/mapsets&quot; | jq
</code></pre>
<p><center>
<a href="../img/curl_output_jq.png"><img src="../img/curl_output_jq.png" width="60%"></a><br>
</center></p>
<h4 id="list-map-layers-and-their-metadata">List map layers and their metadata</h4>
<p>Eventually, digging more for content in "location" and "mapsets", we can look at the datasets stored therein:</p>
<p>Vector data:</p>
<pre><code class="language-bash"># show available vector maps in a specific location/mapset
curl ${AUTH} -X GET &quot;${actinia}/api/v3/locations/nc_spm_08/mapsets/PERMANENT/vector_layers&quot;
curl ${AUTH} -X GET &quot;${actinia}/api/v3/locations/nc_spm_08/mapsets/PERMANENT/vector_layers&quot; | jq

# note: you can always add `| jq`

# show metadata of a specific vector map
curl ${AUTH} -X GET &quot;${actinia}/api/v3/locations/nc_spm_08/mapsets/PERMANENT/vector_layers/geology&quot;
</code></pre>
<p>Raster data:</p>
<pre><code class="language-bash"># show available raster maps in a specific location/mapset
curl ${AUTH} -X GET &quot;${actinia}/api/v3/locations/nc_spm_08/mapsets/PERMANENT/raster_layers&quot;
curl ${AUTH} -X GET &quot;${actinia}/api/v3/locations/nc_spm_08/mapsets/landsat/raster_layers&quot;
curl ${AUTH} -X GET &quot;${actinia}/api/v3/locations/nc_spm_08/mapsets/modis_lst/raster_layers&quot;

# show metadata of a specific raster map
curl ${AUTH} -X GET &quot;${actinia}/api/v3/locations/nc_spm_08/mapsets/landsat/raster_layers/lsat7_2000_40&quot;
</code></pre>
<p>Space-time raster datasets (STRDS):</p>
<pre><code class="language-bash"># show available STRDS in a specific location/mapset
# MODIS Land Surface Temperature data
curl ${AUTH} -X GET &quot;${actinia}/api/v3/locations/nc_spm_08/mapsets/modis_lst/strds&quot;

# show specific STRDS in a specific location/mapset
# MODIS Normalized Difference Vegetation Index
curl ${AUTH} -X GET &quot;${actinia}/api/v3/locations/latlong_wgs84/mapsets/modis_ndvi_global/strds/ndvi_16_5600m&quot;

# Get a list or raster layers from a STRDS
# ECAD: Yearly precipitation
curl ${AUTH} -X GET &quot;${actinia}/api/v3/locations/ECAD/mapsets/PERMANENT/strds/precipitation_1950_2013_yearly_mm/raster_layers&quot;

# Get a list or raster layers from a STRDS, with date filter
# ECAD: Yearly precipitation
curl ${AUTH} -X GET &quot;${actinia}/api/v3/locations/ECAD/mapsets/PERMANENT/strds/precipitation_1950_2013_yearly_mm/raster_layers?where=start_time&gt;'2012-01-01'&quot;
</code></pre>
<h4 id="render-maps">Render maps</h4>
<p>This can be achieved by simply adding <code>/render</code> at the end of a layer resource:</p>
<pre><code class="language-bash">curl ${AUTH} -X GET &quot;${actinia}/api/v3/locations/nc_spm_08/mapsets/PERMANENT/raster_layers/geology_30m/render&quot; &gt; geology_30m.png
curl ${AUTH} -X GET &quot;${actinia}/api/v3/locations/nc_spm_08/mapsets/landsat/raster_layers/lsat7_2000_40/render&quot; &gt; lsat7_2000_40.png

</code></pre>
<h4 id="map-layer-and-space-time-cube-queries">Map layer and space-time cube queries</h4>
<p>It's time to retrieve something from the server. We want to query the stack of multitemporal datasets available and more specifically, retrieve MODIS Land Surface Temperature (LST) values from the space-time cube at a specific position (North Carolina data set; at <a href="https://www.openstreetmap.org/?mlat=36.00&amp;mlon=-78.00#map=10/36.00/-78.00">78W, 36N</a>). For this, we use the endpoint <a href="https://actinia.mundialis.de/api/v3/locations/nc_spm_08/mapsets/modis_lst/strds/LST_Day_monthly/sampling_sync_geojson">sampling_sync_geojson</a>:</p>
<pre><code class="language-bash"># query point value in a STRDS, sending a GeoJSON file of the point position along with the request
# (North Carolina LST time series)
curl ${AUTH} -X POST -H &quot;content-type: application/json&quot; &quot;${actinia}/api/v3/locations/nc_spm_08/mapsets/modis_lst/strds/LST_Day_monthly/sampling_sync_geojson&quot; -d '{&quot;type&quot;:&quot;FeatureCollection&quot;,&quot;crs&quot;:{&quot;type&quot;:&quot;name&quot;,&quot;properties&quot;:{&quot;name&quot;:&quot;urn:ogc:def:crs:EPSG::4326&quot;}},&quot;features&quot;:[{&quot;type&quot;:&quot;Feature&quot;,&quot;properties&quot;:{&quot;cat&quot;:1},&quot;geometry&quot;:{&quot;type&quot;:&quot;Point&quot;,&quot;coordinates&quot;:[-78,36]}}]}'
</code></pre>
<p>Using RESTman you need to pay attention to these changes:</p>
<ul>
<li>change type of request from GET to POST, in the top of the page lefthand of the URL</li>
<li>set the right header <code>content-type</code> and <code>application/json</code> as value</li>
<li>add the JSON in the body section in RAW format</li>
</ul>
<p><center>
<a href="../img/actinia_restman_post.png"><img src="../img/actinia_restman_post.png" width="60%"></a><br>
Fig. 7 RESTman POST request example (source: Luca Delucchi)
</center></p>
<h4 id="sending-json-payload-as-a-file">Sending JSON payload as a file</h4>
<p>In the example above we have sent JSON code to the server directly in the request. However, with longer process chains this is hard to manage. It is often much more convenient to store the JSON code as "payload" in a file and send it to the server:</p>
<pre><code class="language-bash"># note: you can easily generate such a GeoJSON file with ogr2ogr or v.out.ogr
#
# store the query in a JSON file &quot;pc_query_point_.json&quot; (or use a text editor for this)
echo '{&quot;type&quot;:&quot;FeatureCollection&quot;,&quot;crs&quot;:{&quot;type&quot;:&quot;name&quot;,&quot;properties&quot;:{&quot;name&quot;:&quot;urn:ogc:def:crs:EPSG::4326&quot;}},&quot;features&quot;:[{&quot;type&quot;:&quot;Feature&quot;,&quot;properties&quot;:{&quot;cat&quot;:1},&quot;geometry&quot;:{&quot;type&quot;:&quot;Point&quot;,&quot;coordinates&quot;:[-78,36]}}]}' &gt; pc_query_point_.json

# send JSON file as payload to query the STRDS
curl ${AUTH} -X POST -H &quot;content-type: application/json&quot; &quot;${actinia}/api/v3/locations/nc_spm_08/mapsets/modis_lst/strds/LST_Day_monthly/sampling_sync_geojson&quot; -d @pc_query_point_.json  | jq
</code></pre>
<h4 id="validation-of-a-process-chain">Validation of a process chain</h4>
<p>Why validation? It may happen that your JSON file to be sent to the endpoint contains a typo or other invalid content. For the identification of problems prior to executing the commands contained in the JSON file (which may last for hours), it is recommended to validate this file.
For this, actinia can be used as it provides a validation endpoint.</p>
<p>Example: Download the process chain <a href="https://github.com/mundialis/actinia-introduction/raw/main/docs/process_chain_long.json">process_chain_long.json</a> and validate it:</p>
<pre><code class="language-bash"># validation of a process chain (using sync call)
curl ${AUTH} -H &quot;Content-Type: application/json&quot; -X POST &quot;${actinia}/api/v3/locations/nc_spm_08/process_chain_validation_sync&quot; -d @process_chain_long.json
</code></pre>
<h4 id="converting-a-process-chain-back-into-commands">Converting a process chain back into commands</h4>
<p>To turn a process chain back into command style notation, the validator can be used and the relevant code extracted from the resulting JSON response.
Download the process chain <a href="https://gitlab.com/neteler/actinia-introduction/raw/master/docs/process_chain_long.json">process_chain_long.json</a> and extract the section containing the underlying commands by parsing the actinia server response with <code>jq</code>:</p>
<pre><code class="language-bash"># command extraction from a process chain (using sync call) by parsing the 'process_results' response (here we use the `jq` tool:)
curl ${AUTH} --no-progress-meter -H &quot;Content-Type: application/json&quot; -X POST &quot;${actinia}/api/v3/locations/nc_spm_08/process_chain_validation_sync&quot; -d @process_chain_long.json | jq &quot;.&quot;process_results
[
  &quot;grass g.region ['raster=elevation@PERMANENT', 'res=10', '-p']&quot;,
  &quot;grass r.slope.aspect ['elevation=elevation@PERMANENT', 'format=degrees', 'precision=FCELL', 'zscale=1.0', 'min_slope=0.0', 'slope=my_slope', 'aspect=my_aspect', '-a']&quot;,
  &quot;grass r.watershed ['elevation=elevation@PERMANENT', 'convergence=5', 'memory=500', 'accumulation=my_accumulation']&quot;,
  &quot;grass r.info ['map=my_aspect', '-gr']&quot;
]
</code></pre>
<h3 id="data-exchange-import-and-export">Data exchange: import and export</h3>
<p>Actinia can import from external Web resources, use data in the actinia server (persistent and ephemeral storage) and make results available for download as Web resources. These latter can then be downloaded, opened by QGIS, imported into GRASS GIS or other software.
Note that the download of Web resources provided by actinia requires authentication, e.g. the <code>demouser</code>.</p>
<p><strong>Available export formats</strong></p>
<p>At time (more to come) the following export formats are supported:</p>
<ul>
<li>raster: <code>COG</code>, <code>GTiff</code></li>
<li>strds: <code>GTiff</code> (multiple files packed in an tar.gz archive)</li>
<li>vector: <code>PostgreSQL</code>, <code>GPKG</code>, <code>GML</code>, <code>GeoJSON</code>, <code>ESRI_Shapefile</code>, <code>SQLite</code>, <code>CSV</code></li>
<li>file: <code>CSV</code>, <code>TXT</code></li>
</ul>
<h3 id="dealing-with-workflows-processing-chains">Dealing with workflows (processing chains)</h3>
<p>The overall goal is to "get stuff done". In this case it means that we can concatenate (chain) a series of commands where the output of one step may be used as the input of the following step.</p>
<p>The general procedure comprises:</p>
<ul>
<li>prepare a processing chain</li>
<li>compare async(cronous) versus sync(cronous) REST API calls, decide which endpoint to use</li>
<li>submit the processing chain to an actinia endpoint</li>
<li>retrieve the result(s).</li>
</ul>
<!--
(see also: [https://github.com/mundialis/actinia_core/blob/master/scripts/curl_commands.sh#L77](https://github.com/mundialis/actinia_core/blob/master/scripts/curl_commands.sh#L77)
-->

<p>To turn this concept into an example, we use again the process chain <a href="https://gitlab.com/neteler/actinia-introduction/raw/master/docs/process_chain_long.json">process_chain_long.json</a> from above and execute it, here using the asynchonous <code>processing_async_export</code> endpoint. By this, the <code>exporter</code> in the process chain will be activated and deliver the computed maps as Web resources for subsequent download:</p>
<pre><code class="language-bash">curl ${AUTH} --no-progress-meter -H &quot;Content-Type: application/json&quot; -X POST &quot;${actinia}/api/v3/locations/nc_spm_08/processing_async_export&quot; -d @process_chain_long.json | jq
</code></pre>
<p>Being an asynchronous process, the result is not offered directly but at the bottom of the JSON output (in the terminal) a resource ID (red box) and a resource URI is shown:</p>
<p><center>
<a href="../img/curl_resource_id.png"><img src="../img/curl_resource_id.png" width="60%"></a><br>
</center></p>
<p>Use this URI for retrieving the process status, e.g. using your browser (<code>F5</code> to reload page until job is ready).
Once the job has been completed ("Processing successfully finished"), three Web resources (here: COG - Cloud Optimized GeoTIFF) are shown at the bottom of the JSON output:</p>
<pre><code class="language-bash"># update the URI to that of your job, and be sure to use https:
curl ${AUTH} -X GET &quot;https://actinia.mundialis.de/api/v3/resources/demouser/resource_id-284d42c7-9ba7-415d-b675-cf1a534f4af0&quot; | jq

...
  &quot;status&quot;: &quot;finished&quot;,
  &quot;time_delta&quot;: 3.7403182983398438,
  &quot;timestamp&quot;: 1580767679.525925,
  &quot;urls&quot;: {
    &quot;resources&quot;: [
      &quot;http://actinia.mundialis.de/api/v3/resources/demouser/resource_id-284d42c7-9ba7-415d-b675-cf1a534f4af0/my_slope.tiff&quot;,
      &quot;http://actinia.mundialis.de/api/v3/resources/demouser/resource_id-284d42c7-9ba7-415d-b675-cf1a534f4af0/my_aspect.tiff&quot;,
      &quot;http://actinia.mundialis.de/api/v3/resources/demouser/resource_id-284d42c7-9ba7-415d-b675-cf1a534f4af0/my_accumulation.tiff&quot;
    ],
    &quot;status&quot;: &quot;http://actinia.mundialis.de/api/v3/resources/demouser/resource_id-284d42c7-9ba7-415d-b675-cf1a534f4af0&quot;
  },
  &quot;user_id&quot;: &quot;demouser&quot;
}
</code></pre>
<p>The resulting files can now be downloaded (they'll remain for 24 hs on the server).</p>
<p><center>
<a href="../img/qgis_actinia_data_viz.png"><img src="../img/qgis_actinia_data_viz.png" width="60%"></a><br>
Fig. 8: actinia output shown in QGIS (aspect map)
</center></p>
              
            </div>
          </div><footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="Footer Navigation">
        <a href="../2_concepts/" class="btn btn-neutral float-left" title="Some Concepts"><span class="icon icon-circle-arrow-left"></span> Previous</a>
        <a href="../4_clients/" class="btn btn-neutral float-right" title="Client implementations">Next <span class="icon icon-circle-arrow-right"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
          
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
    
      <span><a href="../2_concepts/" style="color: #fcfcfc">&laquo; Previous</a></span>
    
    
      <span><a href="../4_clients/" style="color: #fcfcfc">Next &raquo;</a></span>
    
  </span>
</div>
    <script>var base_url = '..';</script>
    <script src="../js/theme_extra.js" defer></script>
    <script src="../js/theme.js" defer></script>
      <script src="../search/main.js" defer></script>
    <script defer>
        window.onload = function () {
            SphinxRtdTheme.Navigation.enable(true);
        };
    </script>

</body>
</html>
